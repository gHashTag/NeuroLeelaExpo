# 🎲 ПЛАН ДИАГНОСТИКИ КУБИКА - МАКСИМАЛЬНОЕ ЛОГИРОВАНИЕ

## 🚨 **ПРОБЛЕМА:** 
Кубик не нажимается в React Native приложении NeuroLeela.

## 🔍 **ДОБАВЛЕННАЯ ДИАГНОСТИКА:**

### ✅ **GameScreen (rollDice функция):**
- 🎲🎲🎲 [GameScreen-ДИАГНОСТИКА] - логи состояния игрока
- 🎲🎲🎲 [GameScreen-ДИАГНОСТИКА] - логи передачи функции в ChatBot
- 🎲🎲🎲 [GameScreen-ДИАГНОСТИКА] - логи генерации броска
- 🎲🎲🎲 [GameScreen-ДИАГНОСТИКА] - логи отправки в Inngest

### ✅ **ChatBot (DiceButton компонент):**  
- 🎲🎲🎲 [DiceButton-ДИАГНОСТИКА] - логи рендеринга
- 🎲🎲🎲 [DiceButton-ДИАГНОСТИКА] - логи нажатия TouchableOpacity
- 🎲🎲🎲 [DiceButton-ДИАГНОСТИКА] - логи handleRoll функции
- 🎲🎲🎲 [DiceButton-ДИАГНОСТИКА] - логи вызова onRoll prop

### ✅ **ChatBot (handleNewDiceRoll fallback):**
- 🎲🎲🎲 [handleNewDiceRoll-ДИАГНОСТИКА] - логи внешнего/внутреннего onRoll
- 🎲🎲🎲 [handleNewDiceRoll-ДИАГНОСТИКА] - логи блокировок
- 🎲🎲🎲 [handleNewDiceRoll-ДИАГНОСТИКА] - логи отправки событий

## 🧪 **ПЛАН ТЕСТИРОВАНИЯ:**

### 📱 **Шаг 1: Открыть Приложение**
```bash
# Приложение должно быть запущено на http://localhost:8081
open http://localhost:8081
```

### 🎯 **Шаг 2: Навигация в игру**
1. Открыть приложение в браузере
2. Перейти на экран игры (GameScreen)
3. Проверить, что чат и игровое поле загружены

### 🎲 **Шаг 3: Тестирование кубика**
1. **Найти кнопку кубика** в чате или на экране
2. **Нажать на кубик** - смотреть логи в консоли браузера
3. **Ожидаемые логи при нажатии:**

```
🎲🎲🎲 [DiceButton-ДИАГНОСТИКА] TouchableOpacity onPress СРАБОТАЛ!!!
🎲🎲🎲 [DiceButton-ДИАГНОСТИКА] ================ handleRoll: НАЧАЛО ================
🎲🎲🎲 [DiceButton-ДИАГНОСТИКА] handleRoll: КНОПКА КУБИКА НАЖАТА!!!
```

### 🕵️ **Шаг 4: Анализ логов**

#### ❌ **Если кубик НЕ НАЖИМАЕТСЯ:**
- Нет логов `TouchableOpacity onPress СРАБОТАЛ!!!`
- **Причина:** TouchableOpacity заблокирован или не отвечает
- **Проверить:** disabled prop, стили CSS, перекрытие элементов

#### ❌ **Если кубик НАЖИМАЕТСЯ, но нет вызова onRoll:**
- Есть лог `TouchableOpacity onPress СРАБОТАЛ!!!`
- Нет логов `🎲🎲🎲 [GameScreen-ДИАГНОСТИКА] rollDice: Функция вызвана!`
- **Причина:** onRoll prop не передается или неверно связан

#### ❌ **Если onRoll вызывается, но нет событий Inngest:**
- Есть логи GameScreen-ДИАГНОСТИКА
- Нет событий в Inngest (проверить логи Inngest)
- **Причина:** Проблема с InngestEventService

## 🛠️ **ДИАГНОСТИЧЕСКИЕ КОМАНДЫ:**

### 📊 **Проверка состояния серверов:**
```bash
# Проверить Inngest сервер
lsof -i :8288 | cat

# Проверить основное приложение  
lsof -i :8081 | cat
```

### 🔍 **Мониторинг логов Inngest:**
```bash
# Логи сервера должны показывать события game.dice.roll
tail -f inngest-cli.log
```

## 📋 **ЧЕКЛИСТ ДИАГНОСТИКИ:**

- [ ] ✅ Приложение запущено на порту 8081
- [ ] ✅ Inngest сервер запущен на порту 8288  
- [ ] ✅ GameScreen загружен
- [ ] ✅ ChatBot отображается
- [ ] ✅ Кнопка кубика видна
- [ ] ❓ TouchableOpacity onPress срабатывает
- [ ] ❓ handleRoll функция вызывается
- [ ] ❓ onRoll prop передается корректно
- [ ] ❓ rollDice в GameScreen вызывается
- [ ] ❓ Inngest события отправляются
- [ ] ❓ Apollo состояние обновляется

## 🎯 **ОЖИДАЕМЫЙ РЕЗУЛЬТАТ:**
После нажатия кубика должны появиться:
1. Логи нажатия кнопки
2. Логи выполнения rollDice
3. События в Inngest логах  
4. Обновление состояния игрока
5. Визуальная реакция в UI (анимация, сообщения)

---
*Ом Шанти. Диагностика - путь к истине.* 🙏 